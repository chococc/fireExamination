<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sxbang.friday.dao.LoggingEventDao">

	<sql id="where">
		<where>
			<if test="params != null">
							<if test="params.timestmp != null and params.timestmp != ''">
				and timestmp = #{params.timestmp} 
			</if>
			<if test="params.formattedMessage != null and params.formattedMessage != ''">
				and formatted_message = #{params.formattedMessage} 
			</if>
			<if test="params.loggerName != null and params.loggerName != ''">
				and logger_name = #{params.loggerName} 
			</if>
			<if test="params.levelString != null and params.levelString != ''">
				and level_string = #{params.levelString} 
			</if>
			<if test="params.threadName != null and params.threadName != ''">
				and thread_name = #{params.threadName} 
			</if>
			<if test="params.referenceFlag != null and params.referenceFlag != ''">
				and reference_flag = #{params.referenceFlag} 
			</if>
			<if test="params.arg0 != null and params.arg0 != ''">
				and arg0 = #{params.arg0} 
			</if>
			<if test="params.arg1 != null and params.arg1 != ''">
				and arg1 = #{params.arg1} 
			</if>
			<if test="params.arg2 != null and params.arg2 != ''">
				and arg2 = #{params.arg2} 
			</if>
			<if test="params.arg3 != null and params.arg3 != ''">
				and arg3 = #{params.arg3} 
			</if>
			<if test="params.callerFilename != null and params.callerFilename != ''">
				and caller_filename = #{params.callerFilename} 
			</if>
			<if test="params.callerClass != null and params.callerClass != ''">
				and caller_class = #{params.callerClass} 
			</if>
			<if test="params.callerMethod != null and params.callerMethod != ''">
				and caller_method = #{params.callerMethod} 
			</if>
			<if test="params.callerLine != null and params.callerLine != ''">
				and caller_line = #{params.callerLine} 
			</if>
			<if test="params.eventId != null and params.eventId != ''">
				and event_id = #{params.eventId} 
			</if>

			</if>
		</where>
	</sql>

	<select id="count" resultType="int">
		select count(1) from logging_event t
		<include refid="where" />
	</select>

	<select id="list" resultType="LoggingEvent">
		<!--select * from logging_event t-->

		SELECT DATE_FORMAT(a.create_time, '%Y-%m-%d %H:%i:%s')  as timestmp,a.*  from  logging_event a
		<include refid="where" />
		ORDER BY a.timestmp desc  limit #{offset}, #{limit}
	</select>

	<update id="update">
		update logging_event t
		<set>
			<if test="timestmp != null">
				timestmp = #{timestmp}, 
			</if>
			<if test="formattedMessage != null">
				formatted_message = #{formattedMessage}, 
			</if>
			<if test="loggerName != null">
				logger_name = #{loggerName}, 
			</if>
			<if test="levelString != null">
				level_string = #{levelString}, 
			</if>
			<if test="threadName != null">
				thread_name = #{threadName}, 
			</if>
			<if test="referenceFlag != null">
				reference_flag = #{referenceFlag}, 
			</if>
			<if test="arg0 != null">
				arg0 = #{arg0}, 
			</if>
			<if test="arg1 != null">
				arg1 = #{arg1}, 
			</if>
			<if test="arg2 != null">
				arg2 = #{arg2}, 
			</if>
			<if test="arg3 != null">
				arg3 = #{arg3}, 
			</if>
			<if test="callerFilename != null">
				caller_filename = #{callerFilename}, 
			</if>
			<if test="callerClass != null">
				caller_class = #{callerClass}, 
			</if>
			<if test="callerMethod != null">
				caller_method = #{callerMethod}, 
			</if>
			<if test="callerLine != null">
				caller_line = #{callerLine}, 
			</if>
			<if test="eventId != null">
				event_id = #{eventId}, 
			</if>

		</set>
		where t.timestmp = #{timestmp}
	</update>

</mapper>
